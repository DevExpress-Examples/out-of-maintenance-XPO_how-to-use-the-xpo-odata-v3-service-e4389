<!-- default file list -->
*Files to look at*:

* **[XpoOdataService.svc.cs](./CS/ODataService/XpoOdataService.svc.cs) (VB: [XpoOdataService.svc.vb](./VB/ODataService/XpoOdataService.svc.vb))**
* [ClientForm.cs](./CS/ODataV3Example/ClientForm.cs) (VB: [ClientForm.vb](./VB/ODataV3Example/ClientForm.vb))
* [Reference.cs](./CS/ODataV3Example/Service References/Northwind/Reference.cs) (VB: [Reference.vb](./VB/ODataV3Example/Service References/Northwind/Reference.vb))
<!-- default file list end -->
# How to: Use the XPO OData V3 Service


<p>To start the service, run the <strong>ODataService </strong>project. To start the client application, run the <strong>ODataV3Example</strong> project.<br><br><strong>See Also:</strong><br><a href="https://www.devexpress.com/Support/Center/p/E4070">How to implement CRUD operations using XtraGrid and OData</a><br><a href="https://www.devexpress.com/Support/Center/p/E4365">How to implement CRUD operations using XtraGrid and WCF Server Mode</a><br><a href="https://www.devexpress.com/Support/Center/p/K18557">GridControl - How to use the WcfServerModeSource component as a data source</a><br><a href="https://www.devexpress.com/Support/Center/p/E4403">How to process authenticated requests on the OData service</a><br><a href="https://www.devexpress.com/Support/Center/p/E4460">How to send authenticated requests to the OData service</a><br><br><br><strong>IMPORTANT NOTES</strong><br><strong>1.</strong> An OData service created using the <a href="https://documentation.devexpress.com/CoreLibraries/CustomDocument14812.aspx">OData Service Wizard</a> is a <strong>standard</strong> <a href="https://msdn.microsoft.com/library/hh487257(v=vs.103).aspx">WCF Data Service 5+</a> for OData v3. We don't provide documentation on how to consume this service because this task has no XPO-related specifics. Use standard solutions recommended for <a href="http://www.odata.org/">OData</a> services in public community resources like MSDN and StackOverFlow. For instance, you may find these resources helpful:<br>    <a href="https://msdn.microsoft.com/en-us/library/cc668772.aspx">WCF Data Services Client Library</a> <br>    <a href="https://docs.microsoft.com/en-us/dotnet/framework/data/wcf/updating-the-data-service-wcf-data-services">Updating the Data Service (WCF Data Services)</a> and <a href="https://msdn.microsoft.com/en-us/library/dd756368(v=vs.110).aspx">How to: Add, Modify, and Delete Entities (WCF Data Services)</a> <br>    <a href="https://msdn.microsoft.com/en-us/library/cc646716(v=vs.110).aspx">DataServiceContext.SaveChanges</a> and <a href="https://msdn.microsoft.com/en-us/library/system.data.services.client.dataservicecontext.aspx">DataServiceContext</a> <br><strong>2.</strong> Composite keys are not currently supported by XpoDataServiceV3 and it is unlikely that they will be supported in the near future. You may receive the "<em>The entity type 'XXX' does not have any key properties. Please make sure that one or more key properties are defined for this entity type.</em>" error with <a href="https://documentation.devexpress.com/CoreLibraries/14812/DevExpress-ORM-Tool/Design-Time-Features/OData-Service-Wizard">OData Service</a> (XpoDataServiceV3) if you map your persistent class to a table or view with a multi-column key. Since the XAF Mobile UI uses XPO OData Service, this will not work there as well.  In general, we do not recommend using composite keys as they impose many limitations on the default functionality. Refer to the <a href="https://www.devexpress.com/Support/Center/p/A2615">How to create a persistent object for a database table with a compound key</a> article for more details.<br><strong>3.</strong> A WCF Data Service supports custom service methods (Service Operations and Actions) as standard features. Please refer to the corresponding MSDN articles to learn how to implement and use these features in your service: <a href="http://msdn.microsoft.com/en-us/library/cc668788%28v=vs.103%29">Service Operations</a>, <a href="http://msdn.microsoft.com/en-us/library/hh859851%28v=vs.103%29">Service Actions</a>.<br><strong>4.</strong> With the 17.1 release, <a href="https://help.devexpress.com/#CoreLibraries/CustomDocument2056">non-persistent</a> property values can be loaded using the <a href="https://help.devexpress.com/#CoreLibraries/CustomDocument14812">XPO OData Service</a>. To enable this functionality, apply the <a href="https://help.devexpress.com/#CoreLibraries/clsDevExpressXpoVisibleAttributetopic">Visible</a> attribute to a non-persistent property. Our XPO Odata Service will automatically execute your custom business logic associated with this property and return the resulting value to the client.<br><strong>5.</strong> Custom non-persistent types cannot used by the XpoDataServiceV3, which is designed to operate persistent types only. So, for this task, I suggest you continue using a regular non-XPO service. Refer to the <a href="https://www.devexpress.com/Support/Center/p/Q577141">Q577141</a> article for possible solutions.<br><strong>6.</strong> XpoDataServiceV3 provides partial support for annotations. The static <em>XpoDataServiceV3.CreateAnnotationsBuilder</em> method expects a delegate to obtain <em>XpoContext</em> and returns a delegate that adds string fields sizes and read-only flags descriptions to the annotation. You can put this delegate to the service configuration to get these annotations.</p>
<pre class="cr-code"><code>public class XpoTestService : XpoDataServiceV3 {
 public static void InitializeService(DataServiceConfiguration config) {
   ...
   config.AnnotationsBuilder = CreateAnnotationsBuilder(MyGetXpoContextDelegate);
 }
}</code></pre>
<p>If you need to include additional information in annotations, wrap this delegate with your own extended delegate.<br><strong>7.</strong> Properties of the System.Drawing.Image and byte[] types are mapped to the <em>DataServiceStreamLink</em> type in a service reference (Edm.Stream). To get data from this DataServiceStreamLink, use the DataServiceContext.GetReadStream method. Then load an image from the returned Stream. Here is an example from the article's ClientForm.cs file:</p>
<pre class="cr-code"><code>DataServiceStreamResponse resp = context.GetReadStream(context.Categories.Where(i => i.CategoryID == categoryID).Single(), "StreamPicture", new DataServiceRequestArgs());
pictureBox.Image = Image.FromStream(resp.Stream);</code></pre>
<p>To use byte arrays instead of DataServiceStreamLink in your service, override the <em>XpoContext.ShowLargePropertyAsNamedStream</em> method and returning False in it. Refer to the <a href="https://docs.microsoft.com/en-us/dotnet/framework/data/wcf/working-with-binary-data-wcf-data-services">Working with Binary Data (WCF Data Services)</a> article for more details.</p>

<br/>


